// Generated by CoffeeScript 1.7.1
(function() {
  var ModuleConfig, Package, syspath, utils;

  Package = require('../../package');

  syspath = require('path');

  utils = require('../../util');


  /* ---------------------------
      模块配置
      该配置是由指定文件的路径向上迭代得到的, 直到遇见fekit.config文件
  
      {
          //别名的配置
          "alias" : {
              "core" : "./scripts/core"
          }
      }
   */

  ModuleConfig = (function() {
    function ModuleConfig(uri) {
      this.uri = uri;
      this.config = utils.config.parse(this.uri);
    }

    ModuleConfig.prototype.compileType = function() {
      return this.config.root.compiler;
    };

    ModuleConfig.prototype.getCompileType = function() {
      if (!this.config.root.compiler) {
        return ModuleConfig.MODULE_COMPILE_TYPE.NORMAL;
      }
      if (this.config.root.compiler === "modular") {
        return ModuleConfig.MODULE_COMPILE_TYPE.MODULAR;
      }
      if (this.config.root.compiler === "component") {
        return ModuleConfig.MODULE_COMPILE_TYPE.COMPONENT;
      }
      return ModuleConfig.MODULE_COMPILE_TYPE.UNKNOWN;
    };

    ModuleConfig.prototype.isCompileTypeNormal = function() {
      return !this.config.root.compiler;
    };

    ModuleConfig.prototype.isCompileTypeModular = function() {
      return this.config.root.compiler === "modular";
    };

    ModuleConfig.prototype.isCompileTypeComponent = function() {
      return this.config.root.compiler === "component";
    };

    ModuleConfig.prototype.isUseAlias = function(aliasName) {
      return !!this.config.getAlias(aliasName);
    };

    ModuleConfig.prototype.parseAlias = function(aliasName) {
      var path;
      path = this.config.getAlias(aliasName);
      if (!path) {
        return aliasName;
      } else {
        return syspath.join(this.config.fekit_root_dirname, path);
      }
    };

    ModuleConfig.prototype.getPackage = function(aliasName) {
      var p;
      p = new Package(aliasName, null, this.config.fekit_root_dirname);
      return p.get_local_entry();
    };

    return ModuleConfig;

  })();

  ModuleConfig.MODULE_COMPILE_TYPE = {
    NORMAL: 1,
    MODULAR: 2,
    COMPONENT: 3,
    UNKNOWN: 4
  };

  exports.ModuleConfig = ModuleConfig;

}).call(this);
